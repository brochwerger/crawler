version: '3.7'

services:

  #docker run -d -p 8080:8080 -p 4369:4369 -p 5671:5671 -p 5672:5672 -p 25672:25672 --hostname rabbit1 --name rabbit1 rabbitmq:3
  rabbitmq:
    image: rabbitmq:3
    hostname: rabbit1
    networks:
      - test
    ports:
      - "4369:4369"
      - "5671:5671"
      - "5672:5672"
      - "25672:25672"

  redis:
    image: redis
    networks:
      - test
    ports:
      - "6379:6379"

  c1:
    image: nginx

    networks:
      - test

    volumes:
      - ${TESTS_DIR}/circular/c1:/usr/share/nginx/html

    ports:
      - "80:80"

  c2:
    image: nginx

    networks:
      - test

    volumes:
      - ${TESTS_DIR}/circular/c2:/usr/share/nginx/html

  c3:
    image: nginx

    networks:
      - test

    volumes:
      - ${TESTS_DIR}/circular/c3:/usr/share/nginx/html

networks:
  test:
    driver: overlay
    attachable: true